# Changelog

כל השינויים המשמעותיים בפרויקט מתועדים כאן.

## [2.4.0] - 2025-12-09

### ✨ Added - תכונות AI מתקדמות
- **סיכומים חודשיים בשפה טבעית** - AI מייצר תובנות אישיות ומעניינות במקום מספרים יבשים
- **זיהוי אנומליות אוטומטי** - AI מזהה הוצאות חריגות ומתריע על סטיות מהממוצע (50%+)
- **המלצות חיסכון אישיות** - AI מנתח הוצאות חוזרות ומציע דרכים מעשיות לחיסכון
- **ייעוץ פיננסי חכם** - שאל שאלות כמו "האם אני יכול להרשות לעצמי...?" וקבל תשובה מבוססת נתונים
- **יעדי חיסכון חכמים** - מערכת מלאה למעקב יעדים עם חישוב אוטומטי של יעדים שבועיים/חודשיים
- **Parser חכם ליעדים** - כתוב בשפה טבעית "אני רוצה לחסוך 5000 לטיול ליוון" והבוט מבין
- מודל `Goal` חדש למעקב יעדי חיסכון עם סטטוס, התקדמות וזמנים
- פונקציות ב-AI service:
  - `generateMonthlySummaryWithInsights()` - סיכום חודשי בשפה טבעית
  - `detectAnomalies()` - זיהוי הוצאות חריגות
  - `generateSavingsSuggestions()` - המלצות חיסכון
  - `parseGoalFromText()` - פרסור יעדים משפה טבעית עם GPT-4o-mini
- פונקציות ב-WhatsApp service:
  - `handleGoalCreation()` - יצירת יעדים
  - `processGoalInput()` - עיבוד טקסט טבעי ליעד מובנה
  - `showGoals()` - הצגת יעדים עם פס התקדמות ויזואלי
  - `showGoalProgress()` - מעקב מפורט אחר יעד פעיל
  - `handleFinancialAdvice()` - מתן ייעוץ פיננסי אישי
- פקודות חדשות:
  - `/יעד` - יצירת יעד חיסכון בשפה טבעית
  - `היעדים` - רשימת יעדים
  - `התקדמות` - מעקב יעד
  - `האם אני יכול להרשות לעצמי...?` - ייעוץ פיננסי

### 🚀 API - Dashboard Integration
- **Goals API Endpoints** - מערכת מלאה לניהול יעדים דרך Dashboard:
  - `GET /api/goals` - קבלת כל היעדים (עם סינון לפי status)
  - `GET /api/goals/:id` - יעד בודד + סיכום התקדמות
  - `POST /api/goals` - יצירת יעד חדש
  - `PUT /api/goals/:id` - עדכון יעד
  - `DELETE /api/goals/:id` - מחיקת יעד
  - `POST /api/goals/:id/progress` - הוספת התקדמות
  - `GET /api/goals/:id/summary` - סיכום מפורט של יעד
- מודל Goal עם Mongoose מלא:
  - Pre-save hooks לחישוב אוטומטי של progressPercentage, weeklyTarget, monthlyTarget
  - מתודות helper: `addProgress()`, `getTimeRemaining()`, `getProgressSummary()`
  - Validation ואינדקסים אופטימליים
- עדכון server.js עם רשימת endpoints מלאה בגרסה 2.4.0

### 📚 Documentation
- [API_DOCS.md](API_DOCS.md) - תיעוד מפורט של כל ה-API עם דוגמאות
- [DASHBOARD_SYNC_GUIDE.md](DASHBOARD_SYNC_GUIDE.md) - מדריך מלא לסנכרון Dashboard
- [test-api-endpoints.js](test-api-endpoints.js) - סקריפט בדיקה אוטומטי לכל ה-endpoints
- דוגמאות קוד מלאות ל-React/Vue components
- Troubleshooting guide מפורט
- Checklist לסנכרון מלא

### 🔧 Changed
- סיכום חודשי משודרג עם תובנות AI, השוואה לחודש הקודם, זיהוי אנומליות והמלצות חיסכון
- הודעת עזרה מעודכנת עם כל התכונות החדשות
- תיעוד README מורחב עם דוגמאות מפורטות לכל תכונה
- server.js מציג עכשיו את כל ה-endpoints כולל Goals
- תמיכה ב-`source` field בטרנזקציות: `text`, `receipt`, `dashboard`, `api`

### 💡 Improved
- חוויית משתמש אנושית יותר - הבוט מדבר בשפה טבעית במקום הודעות רובוטיות
- תובנות מעמיקות על דפוסי הוצאות אישיים
- המלצות מעשיות מבוססות על נתונים היסטוריים
- אינטגרציה מלאה עם Dashboard - עכשיו אפשר לנהל יעדים גם מהדאשבורד

## [2.3.0] - 2025-12-09

### ✨ Added
- **סריקת קבלות עם Vision AI** - העלאת תמונת קבלה מזהה אוטומטית סכום, עסק, פריטים וקטגוריה
- פונקציה `parseReceipt(imageBase64)` ב-AI service לניתוח קבלות עם GPT-4o Vision
- פונקציה `handleReceiptImage(message)` ב-WhatsApp service לטיפול בתמונות
- זיהוי אוטומטי של הודעות תמונה והפניה למעבד קבלות
- חילוץ מידע מקבלות: סכום, שם עסק, רשימת פריטים, קטגוריה, תאריך
- תמיכה מלאה בקבלות בעברית ובאנגלית
- סימון טרנזקציות מקבלות עם `source: 'whatsapp-receipt'`

### 💡 Improved
- חוויית משתמש משופרת - אפשר לצלם קבלה במקום להקליד ידנית
- דיוק גבוה בזיהוי מידע מקבלות ישראליות

## [2.2.0] - 2025-12-09

### ✨ Added
- **סיכום חודשי אוטומטי** - הבוט שולח אוטומטית בסוף כל חודש (בשעה 20:00) סיכום מפורט לכל משתמש
- **התראות תקציב יזומות יומיות** - הבוט בודק כל יום בשעה 18:00 ומתריע על קטגוריות שמתקרבות לגבול (85%+)
- פונקציה `getMonthlyBudgetComparison()` להשוואת תקציב להוצאות בפועל
- פונקציה `sendMonthlyReportToAllUsers()` לשליחת דוחות חודשיים
- פונקציה `checkAllBudgetsAndAlert()` לבדיקה יומית ושליחת התראות
- תזמון עם node-cron לביצוע משימות מתוזמנות
- הודעת סיכום חודשי מפורטת עם:
  - סטטוס חיסכון או חריגה
  - פירוט לפי קטגוריות
  - התראות על קטגוריות שחרגו
  - עצות מותאמות אישית
- הודעת התראה יומית עם:
  - קטגוריות שחרגו (100%+)
  - קטגוריות קרובות לגבול (85%-99%)
  - טיפים לחיסכון
- סקריפטי בדיקה: `test-monthly-report.js` ו-`test-budget-alerts.js`

### 🔧 Changed
- node-cron נוסף כתלות
- שיפור מנגנון ההתראות - כעת יזום ולא רק תגובתי

### 💡 Improved
- משתמשים מקבלים התראה **לפני** שהם חורגים מהתקציב

## [2.1.0] - 2025-12-08

### ✨ Added
- תמיכה מלאה במשתמשים מרובים - כל משתמש רואה רק את הטרנזקציות שלו
- שדה `userId` בכל הטרנזקציות עם אינדקסים מותאמים
- אבטחה משופרת עם `helmet`, `express-rate-limit`, ו-`express-mongo-sanitize`
- Rate limiting - 100 בקשות ל-15 דקות
- הגבלת גודל body ל-10KB
- תצורת CORS עם אפשרות להגבלת דומיינים
- טיפול משופר בשגיאות OpenAI (insufficient_quota, rate_limit, וכו')
- קובץ `.env.example` לדוגמת תצורה
- תיעוד מלא במדריך README.md
- מדיניות אבטחה ב-SECURITY.md

### 🔧 Changed
- כל פונקציות הסטטיסטיקה עכשיו מקבלות `userId` ומסננות לפי משתמש
- שיפור אינדקסים ב-MongoDB לביצועים טובים יותר
- שיפור הודעות שגיאה מ-AI service

### 🔒 Security
- הוספת sanitization למניעת NoSQL injection
- הוספת helmet לאבטחת HTTP headers
- הוספת rate limiting למניעת abuse
- הגבלת גודל בקשות
- תמיכה ב-CORS מוגבל

### 📝 Documentation
- README מפורט עם כל המידע הדרוש
- SECURITY.md עם המלצות אבטחה
- CHANGELOG.md לתיעוד שינויים

## [2.0.0] - 2023

### Added
- גרסה ראשונית של הבוט
- אינטגרציה עם WhatsApp
- אינטגרציה עם OpenAI
- ניהול תקציבים
- סטטיסטיקות בסיסיות
